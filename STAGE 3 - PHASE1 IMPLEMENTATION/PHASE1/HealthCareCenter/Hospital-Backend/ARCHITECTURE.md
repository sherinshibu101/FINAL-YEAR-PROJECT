# Hospital Backend Architecture Overview

## System Architecture Diagram

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     Hospital Frontend                           â”‚
â”‚  (React + Vite on localhost:5174)                              â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚ - Patient Dashboard                                      â”‚  â”‚
â”‚  â”‚ - Appointment Scheduling                                â”‚  â”‚
â”‚  â”‚ - Lab Results Viewer                                    â”‚  â”‚
â”‚  â”‚ - Prescription Management                               â”‚  â”‚
â”‚  â”‚ - User Authentication (JWT)                             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                           â”‚                                     â”‚
â”‚          â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                    â”‚
â”‚          â”‚ Shares JWT_SECRET               â”‚                    â”‚
â”‚          â–¼                                  â”‚                    â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”‚
â”‚  â”‚ Frontend Server      â”‚        â”‚ Vite Dev Server     â”‚        â”‚
â”‚  â”‚ (Express on 4000)    â”‚        â”‚ (on 5174)           â”‚        â”‚
â”‚  â”‚ - MFA/TOTP           â”‚        â”‚ - Hot reload        â”‚        â”‚
â”‚  â”‚ - Token refresh      â”‚        â”‚ - Routing           â”‚        â”‚
â”‚  â”‚ - Rate limiting      â”‚        â”‚ - UI components     â”‚        â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜        â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                            â–²
                HTTP        â”‚ HTTP (Bearer Token)
         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
         â”‚                                     â”‚
         â–¼                                     â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚  Hospital Backend      â”‚        â”‚  Hospital Backend API        â”‚
â”‚  (Node.js / Express)   â”‚        â”‚  (Express on localhost:3000) â”‚
â”‚  PID: 3000             â”‚        â”‚                              â”‚
â”‚                        â”‚        â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚                        â”‚        â”‚  â”‚ Routes:                â”‚  â”‚
â”‚                        â”‚        â”‚  â”‚ - GET/POST /patients   â”‚  â”‚
â”‚                        â”‚        â”‚  â”‚ - GET/POST /appts      â”‚  â”‚
â”‚                        â”‚        â”‚  â”‚ - GET/POST /lab-tests  â”‚  â”‚
â”‚                        â”‚        â”‚  â”‚ - GET/POST /vitals     â”‚  â”‚
â”‚                        â”‚        â”‚  â”‚ - GET /health          â”‚  â”‚
â”‚                        â”‚        â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                        â”‚        â”‚                              â”‚
â”‚                        â”‚        â”‚  Security:                   â”‚
â”‚                        â”‚        â”‚  - Helmet (HTTP headers)     â”‚
â”‚                        â”‚        â”‚  - Rate limiting             â”‚
â”‚                        â”‚        â”‚  - Async error handling      â”‚
â”‚                        â”‚        â”‚  - CORS protection           â”‚
â”‚                        â”‚        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                        â”‚                    â”‚
â”‚                        â”‚    PostgreSQL      â”‚ pg client
â”‚                        â”‚    Connection      â”‚
â”‚                        â””â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
â”‚                                 â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
                                  â”‚
                    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
                    â”‚   PostgreSQL Database     â”‚
                    â”‚   (Docker on 5432)        â”‚
                    â”‚                           â”‚
                    â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
                    â”‚  â”‚ Schema:             â”‚  â”‚
                    â”‚  â”‚ - users             â”‚  â”‚
                    â”‚  â”‚ - patients          â”‚  â”‚
                    â”‚  â”‚ - appointments      â”‚  â”‚
                    â”‚  â”‚ - lab_tests         â”‚  â”‚
                    â”‚  â”‚ - prescriptions     â”‚  â”‚
                    â”‚  â”‚ - vitals            â”‚  â”‚
                    â”‚  â”‚ - files             â”‚  â”‚
                    â”‚  â”‚ - audit_logs        â”‚  â”‚
                    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
                    â”‚                           â”‚
                    â”‚  Volume: db-data          â”‚
                    â”‚  (persistent storage)     â”‚
                    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Adminer Web UI (Docker on localhost:8080)                     â”‚
â”‚ - Visual database browser                                     â”‚
â”‚ - Query executor                                              â”‚
â”‚ - Database administration                                     â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Data Flow Diagram

```
User (Browser)
      â”‚
      â”‚ Request + JWT Token (Bearer)
      â”‚ http://localhost:5174
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend (React UI)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”‚ API Call (JSON)
      â”‚ POST /api/patients
      â”‚ Authorization: Bearer <JWT>
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Frontend Express Server  â”‚
â”‚ (Port 4000)              â”‚
â”‚ - Verify JWT             â”‚
â”‚ - CORS check             â”‚
â”‚ - Rate limiting          â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”‚ Forward to Backend
      â”‚ http://localhost:3000
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ Backend Express Server       â”‚
â”‚ (Port 3000)                  â”‚
â”‚ - Route matching             â”‚
â”‚ - Request validation         â”‚
â”‚ - Rate limiting              â”‚
â”‚ - JWT verification (future)  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”‚ Query
      â”‚ SELECT * FROM patients
      â”‚
      â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ PostgreSQL Database      â”‚
â”‚ (Port 5432)              â”‚
â”‚ - Execute query          â”‚
â”‚ - Return JSON rows       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
      â”‚
      â”‚ Results (JSON)
      â”‚ [{ id, name, ... }, ...]
      â”‚
      â–¼
Backend Response
      â”‚
      â”‚ JSON Response
      â”‚ { success: true, data: [...] }
      â”‚
      â–¼
Frontend Receives
      â”‚
      â”‚ Update React State
      â”‚ Render UI
      â”‚
      â–¼
User Sees Results
```

---

## Database Schema Relationships

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ users           â”‚ (1)
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚ id (PK, UUID)   â”‚â”€â”€â”€â”€â”€â”€â”‚ appointments (N) â”‚
â”‚ email (UNIQUE)  â”‚      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚ name            â”‚      â”‚ id (PK, UUID)    â”‚
â”‚ role            â”‚      â”‚ doctor_id (FK)   â”‚
â”‚ external_id     â”‚      â”‚ patient_id (FK)  â”‚
â”‚ mfa_enabled     â”‚      â”‚ scheduled_at     â”‚
â”‚ created_at      â”‚      â”‚ status           â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜      â”‚ notes            â”‚
       â–²                 â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚                        â–²
       â”‚                        â”‚
       â”‚                 (1) patients
       â”‚         â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚         â”‚              â”‚              â”‚
    (1)â”‚ (N)  â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
    â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”‚ (other FK refs)    â”‚  â”‚ lab_tests         â”‚
       â”‚      â”‚                    â”‚  â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚      â”‚ patients           â”‚  â”‚ id (PK)           â”‚
       â”‚      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤  â”‚ patient_id (FK)   â”‚
       â”‚      â”‚ id (PK, UUID)      â”‚  â”‚ requested_by (FK) â”‚
       â”‚      â”‚ mrn (UNIQUE)       â”‚  â”‚ test_name         â”‚
       â”‚      â”‚ first_name         â”‚  â”‚ status            â”‚
       â”‚      â”‚ last_name          â”‚  â”‚ result_data       â”‚
       â”‚      â”‚ dob                â”‚  â”‚ result_pdf_key    â”‚
       â”‚      â”‚ gender             â”‚  â”‚ created_at        â”‚
       â”‚      â”‚ contact (JSONB)    â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚      â”‚ insurance (JSONB)  â”‚
       â”‚      â”‚ allergies (JSONB)  â”‚
       â”‚      â”‚ created_at         â”‚
       â”‚      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
       â”‚              â–²
       â”‚ (1)          â”‚
       â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
       â”‚              â”‚
       â”‚         â”Œâ”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚         â”‚               â”‚
       â”‚    prescriptions    vitals
       â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”
       â”‚    â”‚ (FK ref)â”‚    â”‚ (FK ref)â”‚
       â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

      audit_logs
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ actor_id(FK)â”‚â”€â”€â”€â”€â”€â”¬â”€â”€â†’ users (optional)
      â”‚ created_at  â”‚     â”‚
      â”‚ action      â”‚     â””â”€â†’ references resource
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜

      files
      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
      â”‚ owner_patient_id â”‚â”€â”€â†’ patients
      â”‚ uploaded_by (FK) â”‚â”€â”€â†’ users
      â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## Deployment Architecture (Future)

```
Production Environment
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                                                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ CloudFront / CDN (SSL/TLS)                             â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                â”‚                                           â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”â”‚
â”‚  â”‚ Nginx / Load Balancer (Reverse Proxy)                 â”‚â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜â”‚
â”‚                â”‚                                           â”‚
â”‚      â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                               â”‚
â”‚      â”‚                    â”‚                               â”‚
â”‚  â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”        â”Œâ”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”                        â”‚
â”‚  â”‚ Backend  â”‚        â”‚ Frontend â”‚                        â”‚
â”‚  â”‚ Containerâ”‚        â”‚ Containerâ”‚                        â”‚
â”‚  â”‚ (ECS)    â”‚        â”‚ (ECS)    â”‚                        â”‚
â”‚  â””â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”˜        â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
â”‚      â”‚                    â”‚                               â”‚
â”‚      â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                              â”‚
â”‚      â”‚    â”‚                                              â”‚
â”‚      â””â”€â”€â”€â”€â”¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                              â”‚
â”‚           â”‚              â”‚                              â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â” â”Œâ”€â”€â–¼â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                  â”‚
â”‚    â”‚ RDS PostgreSQLâ”‚ â”‚ S3/MinIO    â”‚                  â”‚
â”‚    â”‚ (Multi-AZ)    â”‚ â”‚ (File Store)â”‚                  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                  â”‚
â”‚                                                         â”‚
â”‚    â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚    â”‚ CloudWatch / ELK Logging                       â”‚  â”‚
â”‚    â”‚ X-Ray Tracing                                  â”‚  â”‚
â”‚    â”‚ GuardDuty Security                             â”‚  â”‚
â”‚    â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## File Structure

```
Hospital-Backend/
â”œâ”€â”€ docker-compose.yml          # PostgreSQL + Adminer
â”œâ”€â”€ knexfile.js                 # Knex database config
â”œâ”€â”€ package.json                # Dependencies
â”œâ”€â”€ .env                        # Environment variables (ğŸ”’ not in git)
â”œâ”€â”€ .gitignore                  # Excludes .env
â”‚
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ index.js                # Express server (226 lines)
â”‚   â”‚   â”œâ”€â”€ GET /               # Health check
â”‚   â”‚   â”œâ”€â”€ GET /health         # Kubernetes health
â”‚   â”‚   â”œâ”€â”€ GET/POST /api/patients
â”‚   â”‚   â”œâ”€â”€ GET/POST /api/appointments
â”‚   â”‚   â”œâ”€â”€ GET/POST /api/lab-tests
â”‚   â”‚   â”œâ”€â”€ GET/POST /api/vitals
â”‚   â”‚   â””â”€â”€ Error handling
â”‚   â”‚
â”‚   â”œâ”€â”€ db/
â”‚   â”‚   â””â”€â”€ index.js            # PostgreSQL connection pool
â”‚   â”‚
â”‚   â”œâ”€â”€ migrations/
â”‚   â”‚   â””â”€â”€ 20251127_init.js    # Database schema
â”‚   â”‚       â”œâ”€â”€ CREATE users
â”‚   â”‚       â”œâ”€â”€ CREATE patients
â”‚   â”‚       â”œâ”€â”€ CREATE appointments
â”‚   â”‚       â”œâ”€â”€ CREATE lab_tests
â”‚   â”‚       â”œâ”€â”€ CREATE prescriptions
â”‚   â”‚       â”œâ”€â”€ CREATE vitals
â”‚   â”‚       â”œâ”€â”€ CREATE files
â”‚   â”‚       â””â”€â”€ CREATE audit_logs
â”‚   â”‚
â”‚   â””â”€â”€ seeds/
â”‚       â””â”€â”€ 01_seed_initial_data.js
â”‚           â”œâ”€â”€ 3 users
â”‚           â”œâ”€â”€ 4 patients (from frontend)
â”‚           â”œâ”€â”€ 4 appointments
â”‚           â”œâ”€â”€ 2 vitals records
â”‚           â””â”€â”€ 2 lab tests
â”‚
â”œâ”€â”€ scripts/
â”‚   â””â”€â”€ check_env.js            # Verify environment setup
â”‚
â””â”€â”€ Documentation/
    â”œâ”€â”€ SETUP_COMPLETE.md       # Complete setup details
    â”œâ”€â”€ QUICK_START.md          # 5-minute start guide
    â”œâ”€â”€ ARCHITECTURE.md         # This file
    â””â”€â”€ README.md               # Overview
```

---

## Technology Stack

### Frontend
- **Framework**: React 18
- **Build**: Vite
- **HTTP**: Fetch API
- **Auth**: JWT (Bearer tokens)
- **State**: React useState/Context

### Backend
- **Runtime**: Node.js 18+
- **Framework**: Express.js 4
- **Security**: Helmet, Rate Limiting
- **Database**: PostgreSQL 14
- **ORM/Migration**: Knex.js
- **Auth**: JWT verification (future)

### Infrastructure
- **Container**: Docker / Docker Compose
- **Database**: PostgreSQL 14
- **Networking**: Docker bridge network
- **Storage**: Docker volume (persistent)

### Security Features
- âœ… HTTPS-ready (Helmet)
- âœ… Rate limiting (express-rate-limit)
- âœ… CORS protection
- âœ… JWT authentication (shared secret)
- âœ… Input validation
- âœ… Error masking
- âœ… Audit logging capability
- âœ… File encryption key (AES-256-GCM)

---

## Performance Considerations

### Database
- UUID primary keys for distributed systems
- Indexes on frequently queried fields (external_id)
- Connection pooling via pg
- JSONB for flexible nested data

### API
- Rate limiting: 300 req/min per IP
- Helmet security headers
- Async error handling
- Status codes follow REST conventions

### Frontend
- Vite hot module reloading
- React component lazy loading
- Local storage for tokens

---

## Monitoring & Debugging

### Development
- Check backend logs: Terminal output
- Check database: Adminer at http://localhost:8080
- Check API: Tools like Postman, curl, or browser
- Check frontend: Browser DevTools

### Production (Future)
- CloudWatch Logs
- ELK Stack (Elasticsearch, Logstash, Kibana)
- Sentry for error tracking
- DataDog or New Relic for APM

---

**Last Updated**: 2025-11-27
**Architecture Version**: 1.0
**Status**: âœ… Complete
